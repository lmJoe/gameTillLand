(function () {
	'use strict';

	/**This class is automatically generated by LayaAirIDE, please do not make any modifications. */
	var View=Laya.View;
	var Dialog=Laya.Dialog;
	var Scene=Laya.Scene;
	var REG = Laya.ClassUtils.regClass;
	class homePageUI extends View {
		constructor(){ 
			super();
		}
		createChildren() {
			super.createChildren();
			this.loadScene("scenePages/homePage");
		}
	}
	REG("ui.scenePages.homePageUI",homePageUI);

	var Adapt = new class Adapt{
	  init(view){
	      let baseH=1400, stageH=Laya.stage.height;
	      let ratio=stageH/baseH;
	      this.ratio=ratio;
	      /**头像 */
	      let persionInfo=view.persionInfo;
	      /**金币 */
	      let persionCoin=view.persionCoin;
	      /**操作工 */
	      let operator=view.operator;
	      /**农田 */
	      let fameBox=view.fameBox;
	      fameBox.centerX=0;
	      fameBox.centerY=360*ratio;
	      /**设置按钮 */
	      // let setBtn=view.setBtn;
	      if(stageH<baseH){
	          persionInfo.y*=ratio;
	          persionCoin.y*=ratio;
	          // dialymina.x*=ratio;
	          // task.left*=ratio*2;
	          persionInfo.scale(ratio, ratio);
	          persionCoin.scale(ratio, ratio);
	          operator.scale(ratio, ratio);
	          operator.centerY=-302*ratio;
	          // goldRushBox.centerY=-260*ratio;
	      }
	  }
	};

	var Utils = new class Util{
	  showHandTip(){
	    let sp=Laya.Pool.getItemByCreateFun('hand', ()=>{
	        let sp=new Laya.Sprite();
	        let harvestBtn=new Laya.Sprite();
	        harvestBtn.texture='homePage/havest.png';
	        harvestBtn.name='harvestBtn';
	        // harvestBtn.scale(0.8, 0.8);
	        sp.addChild(harvestBtn);
	        let tl=new Laya.TimeLine();
	        sp.tlMove=tl;
	        tl.to(harvestBtn, {x:0, y:15}, 600).to(harvestBtn, {x:0, y:0}, 600);
	        return sp;
	    });
	    return sp;
	}
	  removeHandTip(target){
	      target.tlMove.pause();
	      target.removeSelf();
	      Laya.Pool.recover('hand', target);
	  }
	};

	class homePages extends homePageUI {

	    constructor() { 
	        super();
	    }
	    
	    onEnable() {
	      Adapt.init(this);
	      this.fameData = [
	        {
	          status:0,
	          cropsImg:'homePage/sow.png',
	          fameImg:'homePage/fameImg.png',
	        },{
	          status:1,
	          cropsImg:'homePage/sow1.png',
	          fameImg:'homePage/fameImg.png',
	        },{
	          status:0,
	          cropsImg:'homePage/sow.png',
	          fameImg:'homePage/fameImg.png',
	        },{
	          status:2,
	          cropsImg:'homePage/sow2.png',
	          fameImg:'homePage/fameImg.png',
	        },{
	          status:2,
	          cropsImg:'homePage/sow2.png',
	          fameImg:'homePage/fameImg.png',
	        },{
	          status:1,
	          cropsImg:'homePage/sow1.png',
	          fameImg:'homePage/fameImg.png',
	        }
	      ];
	      //获取农田
	      this.fameList = this.fameBox.getChildByName("fameList");
	      // this.harvestBtn = this.fameBox.getChildByName("fameList").getChildByName("harvestBtn");

	      this.createGoldRushList(this.fameData);
	    }
	    /**创建列表 */
	    createGoldRushList(Arr){
	      // 使用但隐藏滚动条
	      this.fameList.selectEnable = true;
	      this.fameList.mouseHandler = new Laya.Handler(this, this.onSelect);
	      this.fameList.renderHandler = new Laya.Handler(this, this.updateItem);
	      this.fameList.array = Arr;
	    }
	    updateItem(cell, index) {
	      cell.getChildByName("fameImg").skin = cell.dataSource.fameImg;
	      cell.getChildByName("cropsImg").skin = cell.dataSource.cropsImg;
	      /**
	       * cell.dataSource.status 0-未播种 1-正在成长中 2-已成熟待收获
	       */
	      switch (cell.dataSource.status) {
	        case 0:
	          cell.getChildByName("cropsImg").skin = cell.dataSource.cropsImg;
	          cell.getChildByName("cropsImg").bottom=48;
	          cell.getChildByName("cropsTime").visible = false;
	          // cell.getChildByName("harvestBtn").visible = false;
	          // if(this.spHand){
	          //   Utils.removeHandTip(this.spHand);
	          //   this.spHand=null;
	          // }
	          break;
	        case 1:
	          cell.getChildByName("cropsImg").skin = cell.dataSource.cropsImg;
	          cell.getChildByName("cropsImg").bottom=50;
	          cell.getChildByName("cropsTime").visible = true;
	          // cell.getChildByName("harvestBtn").visible = false;
	          // if(this.spHand){
	          //   Utils.removeHandTip(this.spHand);
	          //   this.spHand=null;
	          // }
	          break;
	        case 2:
	          //待收获 收获icon显示
	          cell.getChildByName("cropsImg").skin = cell.dataSource.cropsImg;
	          cell.getChildByName("cropsImg").bottom=32;
	          cell.getChildByName("cropsTime").visible = false;
	          // cell.getChildByName("harvestBtn").visible = true;
	          this.showHandTip(cell);
	          this.harvestBtn = cell.getChildByName("harvestBtn");
	          break;
	        default:
	          break;
	      }
	      
	    }
	    onSelect(e,i) {
	      var dataSource = e.currentTarget.dataSource;
	      // this.fameData[i].status
	      if (e.type == Laya.Event.MOUSE_UP) {
	        if (e.target.name == 'harvestBtn') {
	          return;
	        }else{
	          switch (dataSource.status) {
	            case 0:
	              alert("开始种植");
	              break;
	            case 1:
	              alert("正在成长中");
	              break;
	            case 2:
	              alert("收获吧");
	              break;
	                
	            default:
	              break;
	          }
	        }
	      }
	      
	      
	    }
	    showHandTip(cell){
	      let harvestBtn=Utils.showHandTip();
	      cell.addChild(harvestBtn);
	      harvestBtn.pos(43, -93);
	      harvestBtn.tlMove.play(0, true);
	      this.harvestBtn=harvestBtn;
	    }
	    harvestClick(){
	      console.log("收获果实");
	    }
	    onDisable() {
	    }
	}

	/**This class is automatically generated by LayaAirIDE, please do not make any modifications. */

	class GameConfig {
	    static init() {
	        //注册Script或者Runtime引用
	        let reg = Laya.ClassUtils.regClass;
			reg("scenePages/homePages.js",homePages);
	    }
	}
	GameConfig.width = 750;
	GameConfig.height = 1624;
	GameConfig.scaleMode ="fixedwidth";
	GameConfig.screenMode = "vertical";
	GameConfig.alignV = "top";
	GameConfig.alignH = "left";
	GameConfig.startScene = "scenePages/homePage.scene";
	GameConfig.sceneRoot = "";
	GameConfig.debug = false;
	GameConfig.stat = false;
	GameConfig.physicsDebug = true;
	GameConfig.exportSceneToJson = true;

	GameConfig.init();

	class Main {
		constructor() {
			//根据IDE设置初始化引擎		
			if (window["Laya3D"]) Laya3D.init(GameConfig.width, GameConfig.height);
			else Laya.init(GameConfig.width, GameConfig.height, Laya["WebGL"]);
			Laya["Physics"] && Laya["Physics"].enable();
			Laya["DebugPanel"] && Laya["DebugPanel"].enable();
			Laya.stage.scaleMode = GameConfig.scaleMode;
			Laya.stage.screenMode = GameConfig.screenMode;
			Laya.stage.alignV = GameConfig.alignV;
			Laya.stage.alignH = GameConfig.alignH;
			//兼容微信不支持加载scene后缀场景
			Laya.URL.exportSceneToJson = GameConfig.exportSceneToJson;

			//打开调试面板（通过IDE设置调试模式，或者url地址增加debug=true参数，均可打开调试面板）
			if (GameConfig.debug || Laya.Utils.getQueryString("debug") == "true") Laya.enableDebugPanel();
			if (GameConfig.physicsDebug && Laya["PhysicsDebugDraw"]) Laya["PhysicsDebugDraw"].enable();
			if (GameConfig.stat) Laya.Stat.show();
			Laya.alertGlobalError(true);

			//激活资源版本控制，version.json由IDE发布功能自动生成，如果没有也不影响后续流程
			Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION);
		}

		onVersionLoaded() {
			//激活大小图映射，加载小图的时候，如果发现小图在大图合集里面，则优先加载大图合集，而不是小图
			Laya.AtlasInfoManager.enable("fileconfig.json", Laya.Handler.create(this, this.onConfigLoaded));
		}

		onConfigLoaded() {
			//加载IDE指定的场景
			GameConfig.startScene && Laya.Scene.open(GameConfig.startScene);
		}
	}
	//激活启动类
	new Main();

}());
